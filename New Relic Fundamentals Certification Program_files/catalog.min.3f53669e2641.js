function CatalogSearch(a,b,c,d,e,f){function g(a){ga&&console.info(a)}function h(a,b,c){b in a||(a[b]=Array()),a[b].push(c)}function i(){fa&&(ea=Array())}function j(a,b,c){if(g("setup"),a||b){b&&c&&(O=c),aa=Array(),da=Object(),da["-l"]=Array(),ca=Object(),Q&&$(Q).each(function(c,d){g("tile found");var e=$(d);if(e.hasClass("search-only")||aa.push(d),b&&h(da,e.data("type"),d),a){var f=_.without(e.data("tags").toString().split(","),"");d.tagArray=f,$.each(f,function(a,b){h(ca,b,d)}),g(ca)}});var d=Array();a&&$(S).each(function(a,b){var c=$(b),e=c.data("group"),f=c.data("tag");d.push(e+Y+f)}),Z=Object.keys(da).concat(d),C(!0),b&&s(),$(".filter-results").css("visibility",ha.showOverallResultCounts?"visible":"hidden"),y(),fa=!0}}function k(){$(".top-row").removeClass("search"),$(".catalog-search-info-header-number-results").text("Searching...")}function l(){$(".top-row").addClass("search")}function m(){Q&&$(Q).addClass("filtered")}function n(){Q&&$(Q).removeClass("filtered")}function o(a){function b(b,c){if(a)var d=$.inArray($(b).data("oid"),a),e=$.inArray($(c).data("oid"),a);else{var d=$(b).data("order"),e=$(c).data("order");d=isInteger(d)?d:-1,e=isInteger(e)?e:-1}return d>e?1:-1}if(Q){var c=$("#catalog-courses"),d=c.children(Q);d.sort(b),d.detach().appendTo(c)}}function p(){return void 0!==O}function q(){g("clearSearch()"),Q&&$(Q).addClass("filtered"),$(V).val(""),O=void 0,z(),k(),H(),o(),Q&&$(Q).removeClass("not-found filtered"),y()}function r(a,b){!a||"click"!=a.type&&13!=(a.which?a.which:a.keyCode)||$("body, .cbp-spmenu-left").removeClass("cbp-spmenu-open"),O=b,ja()}function s(){if("undefined"!=typeof O)return O=$.trim(O),z(O),O?void index.search({query:O,typoTolerance:!c},function(a,b){if(!a){m(),i(),l();var c=Array();$.each(b.hits,function(a,b){c.push(b.pcoid||b.lid),"Lesson"==b.type&&t(b.lid,b.lesson_title,b.icon,b.coid)}),Q&&(ba=$(Q).filter(function(a,b){var d=$(b).data("oid");if(d&&!($.inArray(d,c)<0))return!0}).get()),o(c),y(),n()}}):void q()}function t(b,c,d,e){if(!(b in X)){var f=$(T).clone(!0,!0),g=null;if(Q){g=$(Q+"[data-coid="+e+"]"),f[0].tagArray=g[0].tagArray,g.hasClass("sj-registration-closed")&&f.addClass("sj-registration-closed"),g.hasClass("sj-registration-not-required")&&f.addClass("sj-registration-not-required"),f.attr("data-tags",g.attr("data-tags")),f.attr("href",g.attr("href")+"/"+b),f.find(".coursebox-text").html(escapeHtml(c)),f.attr("data-oid",b),f.children(".storefront-price").append(g.children(".storefront-price").html());var i=g.find(".coursebox-text").text().trim();f.find(".coursebox-text-description-target").html(escapeHtml(i)),f.find(".coursebox-image .coursebox-image-inner-wrapper").html(ia[d]||'<i class="icon-video"></i>'),f.find(".lesson-data-tags").html(g.attr("data-tags")),$("#catalog-courses").append(f)}h(da,f.attr("data-type"),f.get()[0]),a&&$.each(f[0].tagArray,function(a,b){h(ca,b,f.get()[0])}),X[b]=!0}}function u(){return _.union.apply(null,_.values(v()))}function v(){g("getActiveFilterTypeToTileMap()");var a=$(R+".checked").map(function(a,b){return $(b).data("type")}).get();0===_.size(a)&&(a=Object.keys(da));var b=Object();return $.each(a,function(a,c){b[c]=da[c]}),b}function w(){g("getActiveFilterTagToTileMap()");var a=Object();$(S+".checked").each(function(b,c){var d=$(c),e=d.data("group"),f=d.data("tag");e in a||(a[e]=Array()),a[e].push(ca[f])});var b=Object();return $.each(a,function(a,c){b[a]=_.union.apply(null,c)}),b}function x(){return p()?ba:aa}function y(){g("doFilter()");var c=x(),d=u(),f=w(),h=_.values(f),i=_.size(ea)>0;i&&h.push(_.union.apply(null,ea));var j=_.intersection.apply(null,h),k=_.size(f)>0,l=c;k||"undefined"!=typeof O?($(U).addClass("is-visible"),$(W).addClass("display")):($(U).removeClass("is-visible"),$(W).removeClass("display")),p()&&(l=_.intersection(c,d));var m=l;if((k||i)&&(m=_.intersection(l,j)),Q&&$(Q).addClass("not-found"),$.each(m,function(a,b){$(b).removeClass("not-found")}),ha.showOverallResultCounts){var n=_.size(m);$(".filter-results .filter-results-count").text(n)}if(p()){var o=c;k&&(o=_.intersection(o,j)),$(R).each(function(a,b){var c=$(b),d=c.data("type"),e=_.intersection(o,da[d]),f=_.size(e);c.find(".filter-counter").text("("+f+")")})}var q=[];a&&$(S).each(function(a,b){var c=$(b),d=c.data("group"),e=c.data("tag");q.push(e);var g=void 0,h="";if(c.hasClass("checked"))ha.showSelectedTagCounts&&(g=_.size(_.intersection(m,ca[e])));else if(d in f){var i=Array();i.push(l),i.push(ca[e]),$.each(f,function(a,b){a!=d&&i.push(b)}),g=_.size(_.union(m,_.intersection.apply(null,i)))-_.size(m),h="+"}else g=_.size(_.intersection(m,ca[e]));var j="";void 0!==g&&(j="("+h+g+")"),c.find(".filter-counter").text(j)}),(a||b)&&e({selectedTagSlugs:q})}function z(a){function b(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16)})}if(history.pushState){var c=window.location.href,d=window.location.protocol+"//"+window.location.host+window.location.pathname,e=Array();O&&e.push("q="+b(O));var f=RegExp("d=([a-z0-9]+)"),g=f.exec(c);g&&e.push("d="+g[1]),_.size(e)>0&&(d+="?"+e.join("&")),window.location.hash&&(d+=window.location.hash),d!=c&&window.history.pushState({path:d},"",d)}}function A(){g("filtersToHash()"),window.location.hash=_.uniq($(R).not(".checked").add(S+".checked").map(function(){return $(this).data("type")||$(this).data("group")+Y+$(this).data("tag")}).get()).sort().join(",")}function B(){var b=Array();if(p()){var c=$(R).not(".checked").map(function(){return $(this).data("type")}).get();b=b.concat(c)}if(a){var d=$(S+".checked").map(function(){return $(this).data("group")+Y+$(this).data("tag")}).get();b=b.concat(d)}return b}function C(a){g("hashToFilters()");var b=_.uniq(window.location.hash.substring(1).match(/[-a-z0-9_]+/g));if(b){var c=b;ea=Array(),c=$.map(b,function(a){if("-c-"===a)return"-c";if("-l-"===a)return"-l";if("-"===a[0])return a;if(!_.contains(a,Y)){var b="categories"+Y+a;if(_.indexOf(Z,b)!==-1)return b;ea.push(ca[a])}return a});var c=_.intersection(c,Z);_.size(c)!==_.size(_.intersection(c,B()))&&(L(),H(),$.each(c,function(a,b){"-"===b[0]?G(b):J(b)}))}}function D(){g("onHashChange()"),a&&(C(),y())}function E(a){if(g("toggleFilterType()"),b){var c=$(a.target).closest(R);c.hasClass("checked")?G(c.data("type")):F(c.data("type")),A(),y()}}function F(a){g("addFilterType()"),b&&($(R+"[data-type="+a+"]").addClass("checked").removeClass("notchecked"),i())}function G(a){g("removeFilterType()"),b&&($(R+"[data-type="+a+"]").addClass("notchecked").removeClass("checked"),i())}function H(){g("setAllFilterTypes()"),b&&($(R).addClass("checked").removeClass("notchecked"),i())}function I(b){if(g("toggleFilterTag()"),a){var c=$(b.target).closest(S);c.hasClass("checked")?K(c.data("group")+Y+c.data("tag")):J(c.data("group")+Y+c.data("tag")),A(),y()}}function J(b){if(g("addFilterTag()"),a){var c=b.split(Y),d=c[0],e=c[1];$(S+"[data-group="+d+"][data-tag="+e+"]").addClass("checked"),i()}}function K(b){if(g("removeFilterTag()"),a){var c=b.split(Y),d=c[0],e=c[1];$(S+"[data-group="+d+"][data-tag="+e+"]").removeClass("checked"),i()}}function L(){g("clearFilterTags()"),a&&($(S).removeClass("checked"),i())}function M(){g("clearFilterTagsAndUpdate()"),L(),A(),y()}function N(a,b){a in ha&&(ha[a]=Boolean(b),$(".filter-results").css("visibility",ha.showOverallResultCounts?"visible":"hidden"),y())}var O,P=200,Q=f&&f.courseboxSelector||"#catalog-content a.coursebox-container",R=f&&f.typeSelector||".filter-option-type",S=f&&f.tagSelector||".filter-option-tag",T=f&&f.lessonTileStubSelector||"#catalog-stubs a.lesson",U=f&&f.resetButtonSelector||".catalog-search-reset",V=f&&f.searchInputSelector||".catalog-search-input",W=f&&f.viewResultsSelector||".view-results-wrapper",X={},Y="_",Z=Array(),aa=Array(),ba=Array(),ca=Object(),da=Object(),ea=Array(),fa=!1,ga=!1,ha={showOverallResultCounts:!1,showSelectedTagCounts:!1},ia={VIDEO:'<i class="icon-video" aria-hidden="true"></i>',PDF:'<i class="icon-pdf" aria-hidden="true"></i>',TEXT:'<i class="icon-text" aria-hidden="true"></i>',AUDIO:'<i class="icon-audio" aria-hidden="true"></i>',SLIDESHOW:'<i class="icon-slideshow" aria-hidden="true"></i>',FORM:'<i class="icon-form" aria-hidden="true"></i>',IMAGE:'<i class="fa fa-picture-o" style="padding-top: 1px;" aria-hidden="true"></i>',QUIZ:'<i class="fa fa-check-square-o" aria-hidden="true"></i>',VILT:'<i class="fa fa-calendar" aria-hidden="true"></i>',UNKNOWN:'<i class="icon-video" aria-hidden="true"></i>'},ja=_.debounce(s,P);return j(a,b,d),{startSearch:r,clearSearch:q,clearFilterTagsAndUpdate:M,toggleFilterType:E,toggleFilterTag:I,onHashChange:D,setOption:N,setup:j}}var _extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function(a,b){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.LazyLoad=b()}(this,function(){"use strict";var a={elements_selector:"img",container:window,threshold:300,throttle:150,data_src:"src",data_srcset:"srcset",class_loading:"loading",class_loaded:"loaded",class_error:"error",class_initial:"initial",skip_invisible:!0,callback_load:null,callback_error:null,callback_set:null,callback_processed:null,callback_enter:null},b=!("onscroll"in window)||/glebot/.test(navigator.userAgent),c=function(a,b){a&&a(b)},d=function(a){return a.getBoundingClientRect().top+window.pageYOffset-a.ownerDocument.documentElement.clientTop},e=function(a,b,c){var e=b===window?window.innerHeight+window.pageYOffset:d(b)+b.offsetHeight;return e<=d(a)-c},f=function(a){return a.getBoundingClientRect().left+window.pageXOffset-a.ownerDocument.documentElement.clientLeft},g=function(a,b,c){var d=window.innerWidth,e=b===window?d+window.pageXOffset:f(b)+d;return e<=f(a)-c},h=function(a,b,c){var e=b===window?window.pageYOffset:d(b);return e>=d(a)+c+a.offsetHeight},i=function(a,b,c){var d=b===window?window.pageXOffset:f(b);return d>=f(a)+c+a.offsetWidth},j=function(a,b,c){return!(e(a,b,c)||h(a,b,c)||g(a,b,c)||i(a,b,c))},k=function(a,b){var c,d="LazyLoad::Initialized",e=new a(b);try{c=new CustomEvent(d,{detail:{instance:e}})}catch(f){c=document.createEvent("CustomEvent"),c.initCustomEvent(d,!1,!1,{instance:e})}window.dispatchEvent(c)},l=function(a,b){var c=b.length;if(c)for(var d=0;d<c;d++)k(a,b[d]);else k(a,b)},m="data-",n=function(a,b){return a.getAttribute(m+b)},o=function(a,b,c){return a.setAttribute(m+b,c)},p=function(a,b){var c=a.parentNode;if("PICTURE"===c.tagName)for(var d=0;d<c.children.length;d++){var e=c.children[d];if("SOURCE"===e.tagName){var f=n(e,b);f&&e.setAttribute("srcset",f)}}},q=function(a,b,c){var d=a.tagName,e=n(a,c);if("IMG"===d){p(a,b);var f=n(a,b);return f&&a.setAttribute("srcset",f),void(e&&a.setAttribute("src",e))}return"IFRAME"===d?void(e&&a.setAttribute("src",e)):void(e&&(a.style.backgroundImage='url("'+e+'")'))},r="classList"in document.createElement("p"),s=function(a,b){return r?void a.classList.add(b):void(a.className+=(a.className?" ":"")+b)},t=function(a,b){return r?void a.classList.remove(b):void(a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,""))},u=function(b){this._settings=_extends({},a,b),this._queryOriginNode=this._settings.container===window?document:this._settings.container,this._previousLoopTime=0,this._loopTimeout=null,this._boundHandleScroll=this.handleScroll.bind(this),this._isFirstLoop=!0,window.addEventListener("resize",this._boundHandleScroll),this.update()};u.prototype={_reveal:function(a){var b=this._settings,d=function f(){b&&(a.removeEventListener("load",e),a.removeEventListener("error",f),t(a,b.class_loading),s(a,b.class_error),c(b.callback_error,a))},e=function g(){b&&(t(a,b.class_loading),s(a,b.class_loaded),a.removeEventListener("load",g),a.removeEventListener("error",d),c(b.callback_load,a))};c(b.callback_enter,a),"IMG"!==a.tagName&&"IFRAME"!==a.tagName||(a.addEventListener("load",e),a.addEventListener("error",d),s(a,b.class_loading)),q(a,b.data_srcset,b.data_src),c(b.callback_set,a)},_loopThroughElements:function(){var a=this._settings,d=this._elements,e=d?d.length:0,f=void 0,g=[],h=this._isFirstLoop;for(f=0;f<e;f++){var i=d[f];a.skip_invisible&&null===i.offsetParent||(b||j(i,a.container,a.threshold))&&(h&&s(i,a.class_initial),this._reveal(i),g.push(f),o(i,"was-processed",!0))}for(;g.length;)d.splice(g.pop(),1),c(a.callback_processed,d.length);0===e&&this._stopScrollHandler(),h&&(this._isFirstLoop=!1)},_purgeElements:function(){var a=this._elements,b=a.length,c=void 0,d=[];for(c=0;c<b;c++){var e=a[c];n(e,"was-processed")&&d.push(c)}for(;d.length>0;)a.splice(d.pop(),1)},_startScrollHandler:function(){this._isHandlingScroll||(this._isHandlingScroll=!0,this._settings.container.addEventListener("scroll",this._boundHandleScroll))},_stopScrollHandler:function(){this._isHandlingScroll&&(this._isHandlingScroll=!1,this._settings.container.removeEventListener("scroll",this._boundHandleScroll))},handleScroll:function(){var a=this._settings.throttle;if(0!==a){var b=Date.now(),c=a-(b-this._previousLoopTime);c<=0||c>a?(this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._previousLoopTime=b,this._loopThroughElements()):this._loopTimeout||(this._loopTimeout=setTimeout(function(){this._previousLoopTime=Date.now(),this._loopTimeout=null,this._loopThroughElements()}.bind(this),c))}else this._loopThroughElements()},update:function(){this._elements=Array.prototype.slice.call(this._queryOriginNode.querySelectorAll(this._settings.elements_selector)),this._purgeElements(),this._loopThroughElements(),this._startScrollHandler()},destroy:function(){window.removeEventListener("resize",this._boundHandleScroll),this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._stopScrollHandler(),this._elements=null,this._queryOriginNode=null,this._settings=null}};var v=window.lazyLoadOptions;return v&&l(u,v),u});